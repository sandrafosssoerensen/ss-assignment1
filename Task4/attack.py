import base64, json

cookie = "eyJtc2ciOiAiNTk2Zjc1MjA2NzY1NzQyMDYxMjA2ZjZlNmM3OTIwNjc2NTc0MjA2MTIwMzAzMDIwNjk2ZTIwNTM3OTczNzQ2NTZkNzMyMDUzNjU2Mzc1NzI2OTc0NzkyZTIwNDkyMDYxNmQyMDc2NjU3Mjc5MjA2NDY5NzM2MTcwNzA2ZjY5NmU3NDY1NjQyMDYyNzkyMDc5NmY3NTJlIiwgImNpcGhlcnRleHQiOiAiODdmNjg3ZWRkMjkzNjU1ZmJiNmFlMTExZDA1MDIzNTYyZmMxMTI5ZGMxMWI5OTBkZDExNjdiMTFiOTQ3NzE3Njc0MjkzZGNlOTAyNWEzNzM2OTMzYmRiNGIyMjRhMDgyMzM1NGJhNWI0YmQ4ZDkwZDA1MTRiNDRkMmViNmZlZWEwODI0MjI0ZjAwMGU1YTAzN2NkM2MyN2YxMGQxNjdiN2I2ODQ1NmUxOTlmMTM0ZmU4ZTQ5YzI1MDMyZDVhZmFkMTJiNmY0MDc2MzA3YzM3NmYyMzFhOTE0NWE5NmZkNGI4MmU4MGQ2NjJhOGQ5YTk3MjFkMTM0OWUxZmNiZDY1MDU3MzZkOTIyOTVhYjgwYzk2Nzg5YmM1OGMxNzUzYjhhN2VhOGYwNGZhNGFmZmQ4Y2RkMTZhMWU1NTRkMTZkNjM1ZGVmZmU4YzZkZTQyMjQ1OGUwMDkxYWI5NzQ4YWExM2U0MGEwZDk3NzEyMTM5YTA4OWVjNWE4Nzk1Zjc5NjVlYTU3MmM2NWIwOGVhZGEwYWEyYzI5ODMxODA0NTMzNTk1ODk3ZDU2M2E0NGNjZjBkNTFmYmIyMzliNTYyMDY4NWMwZTA1MjZiZDAyYTdhODM2YWY4OTY5NWYzNWZmZDVmZmFlN2YxZjE1OWZiMGY0NDc2MmRjZDcxNTUxYTBjNzI1Zjc2ODA0MWE2MzQ0OTZiNmZkZWVhOTE4MjgxZjE3Y2ZkOWIxNWU3ZWQ2NjE1ZjVkMjJiOWQzYjVmM2I0YjYyZjBkNGRhOTE3ZjI5Njk5OTgzNTAzMTAwN2IzM2Y4ZTZlMDVmMGQ3NDdhNjNhODI4MDlhODQxMjkwN2VkNThiMDFlOGU1YzcyYjg3NWM5M2ZiNDM4ZWYxYmVmODQzNTE2M2UwY2Q4MThjY2Q0MWJlYTk5Njc3OTQzYTJmZDFkYjNjNmQ0MDAzMzE4MzYyYWI2ZjYwMTNlMmFkZDZmYzc1MzhkYjEyMWM5YjY5ZjNhMGI0YmQyNjFiZTY3Mzg3MjY4ZjRhNGUxYWQ3Mzk5N2U5MmQ3ZWUzN2RjMjM4MDczMGE5ZGVlODA3N2FjMzUwYjVkMDQyYzljNDE4NGRhZTgzMjhkZDUzYTE4MjM5MDA2MjVhNzRmMjQ2ZTFjM2Y3MDJiYmZhZDkwNjdlM2IwNTM0YjYxNzg0YjJiOTRjMmQ0MjlkNThlYjM0OTA2NTAzNDFkMDliZGE4NjY2ZjJkNTQxYmY3OWVmODUxMzM4YTJkNjBkM2ZiMDlmNjMyNjI5OWE2Y2JkZmRkMGQyNDU1M2NlYmZiZGE4NzE5NmM0MjQxYmE1ODBiOTkxYmZkZWQ1YmRkODg0M2UzOWQ4Y2QwZGMxYiJ9"

decoded = base64.urlsafe_b64decode(cookie)
data = json.loads(decoded)

cipher_hex = data["ciphertext"]
msg_hex = data["msg"]

cipher = bytes.fromhex(cipher_hex)
msg = bytes.fromhex(msg_hex)

print(msg)

from math import ceil

p = 32317006071311007300338913926423828248817941241140239112842009751400741706634354222619689417363569347117901737909704191754605873209195028853758986185622153212175412514901774520270235796078236248884246189477587641105928646099411723245426622522193230540919037680524235519125679715870117001058055877651038861847280257976054903569732561526167081339361799541336476559160368317896729073178384589680639671900977202194168647225871031411336429319536193471636533209717077448227988588565369208645296636077250268955505928362751121174096972998068410554359584866583291642136218231078990999448652468262416972035911852507045361090559

length = ceil(p.bit_length()/8)

c1 = int.from_bytes(cipher[:length],'big')
c2 = int.from_bytes(cipher[length:],'big')

target = b"You got a 12 because you are an excellent student! :)"

m  = int.from_bytes(msg,'big')
mt = int.from_bytes(target,'big')

k = (mt * pow(m,-1,p)) % p
c2_new = (c2 * k) % p
new_cipher = c1.to_bytes(length,'big') + c2_new.to_bytes(length,'big')

forged = json.dumps({
    "msg": target.hex(),
    "ciphertext": new_cipher.hex()
})

cookie_out = base64.urlsafe_b64encode(forged.encode()).decode()

print(cookie_out)